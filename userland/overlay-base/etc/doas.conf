# ForgeOS doas Configuration
# Security Baseline - THE-52
# Minimal privilege escalation policy

# Allow forgeos user to run commands as root with password
permit persist forgeos as root

# Allow specific users to run specific commands without password
# Example: allow chrony user to adjust time
# permit nopass chrony cmd /usr/sbin/chronyd

# Allow wheel group members to run commands as root (with password)
permit persist :wheel

# Deny by default
# All other users and commands are denied unless explicitly permitted above

# Security options
# - persist: cache authentication for a short time
# - keepenv: preserve environment variables (use with caution)
# - nopass: allow without password (use very sparingly)

# Examples of service-specific rules:
# permit nopass update as root cmd /usr/sbin/apk args upgrade
# permit nopass log as root cmd /usr/bin/logrotate


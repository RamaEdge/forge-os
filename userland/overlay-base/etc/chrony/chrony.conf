# ForgeOS Chrony Configuration
# Implements THE-53 (Networking)
# Minimal time synchronization configuration for edge devices

# NTP servers (use multiple sources for reliability)
# Default to public NTP pool
server 0.pool.ntp.org iburst
server 1.pool.ntp.org iburst
server 2.pool.ntp.org iburst
server 3.pool.ntp.org iburst

# Alternative: Use specific time servers
# Uncomment and configure as needed:
# server time.cloudflare.com iburst
# server time.google.com iburst
# server time.apple.com iburst

# Drift file location
driftfile /var/lib/chrony/chrony.drift

# Directory for dump files
dumpdir /var/lib/chrony

# RTC (Real-Time Clock) support
# Enable if hardware RTC is present
rtcsync

# Make chrony usable as an NTP server (optional)
# Uncomment to allow clients to sync from this system:
# allow 192.168.0.0/16

# Step the system clock if offset is larger than 1 second
# but only in the first three clock updates
makestep 1.0 3

# Log files
logdir /var/log/chrony
# log tracking measurements statistics

# Minimal logging for edge devices
log tracking

# Reduce memory usage
maxsamples 16

# Enable kernel time synchronization
rtconutc

# Leap second handling
leapsectz right/UTC

# Command key for chronyc authentication
# Generate with: chronyc keygen /etc/chrony/chrony.keys
# keyfile /etc/chrony/chrony.keys

# Allow command only from localhost
cmdallow 127.0.0.1
cmdallow ::1

# Security: Restrict access to chronyc commands
# Only local connections allowed by default

# Fallback behavior
# If all sources become unreachable, use local reference
# local stratum 10

# Hardware timestamping (if supported by network interface)
# hwtimestamp *

# Optimize for minimal resource usage (edge devices)
# noclientlog: Don't log client accesses
noclientlog

# minpoll/maxpoll: Reduce polling frequency to save bandwidth
# Default: minpoll 6 (64s), maxpoll 10 (1024s)
# For edge: slightly less frequent
# minpoll 7
# maxpoll 12


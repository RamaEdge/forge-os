#!/bin/sh
# ForgeOS core-net Profile /etc/init.d/rcS
# System startup script for network-enabled systems

echo "Starting ForgeOS core-net system initialization..."

# Mount virtual file systems
echo "Mounting virtual file systems..."
mount -a

# Create device nodes
echo "Creating device nodes..."
mdev -s

# Set up networking
echo "Setting up networking..."
ifconfig lo 127.0.0.1 up
route add -net 127.0.0.0 netmask 255.0.0.0 lo

# Start network services (THE-53)
echo "Starting network services..."
if [ -x /etc/init.d/networking ]; then
    /etc/init.d/networking start
fi

# Start system services
echo "Starting system services..."
syslogd
klogd

# Start firewall (THE-53)
echo "Starting firewall..."
if [ -x /etc/init.d/nftables ]; then
    /etc/init.d/nftables start
fi

# Start time synchronization (THE-53)
echo "Starting time synchronization..."
if [ -x /etc/init.d/chronyd ]; then
    /etc/init.d/chronyd start
fi

# Set hostname
echo "Setting hostname..."
hostname forgeos-core-net

# Initialize random number generator
echo "Initializing random number generator..."
dd if=/dev/urandom of=/dev/null bs=1024 count=1 2>/dev/null

echo "ForgeOS core-net system initialization complete."
echo "System ready for network operation."
